<!DOCTYPE html>
<html>

    <head>
        <title>TheKarte</title>
        <style>
        body {
            margin: 0px;
        }

        body>div {
            width: 100%;
            height: 100%;
            position: absolute;
        }

        </style>

        <script src="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.1.3/build/ol.js"></script>
        <link rel="stylesheet" href="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.1.3/css/ol.css">

        <script src="src/MenuActionAbstract.js"></script>
        <script src="src/MenuActionFeature.js"></script>
        <script src="src/MenuActionExport.js"></script>
        <script src="src/MenuActionHelp.js"></script>
        <script src="src/MenuActionLayer.js"></script>
        <script src="src/MenuActionView.js"></script>
        <script src="src/KeyboardMenu.js"></script>
        <script src="src/AutomaticStylerFactory.js"></script>
        <script src="src/TheKarte.js"></script>
    </head>

    <script>
    var theKarte;

    function TheKarteLoad() {
        theKarte = new TheKarte();

        var keyboardMenu = new KeyboardMenu(
            new Map([
                //show menu structure
                ['h', new MenuActionHelp(theKarte)],

                //Settings mode
                ['s', new Map([
                    ['f', new MenuActionViewPerformance(theKarte, true)],
                    ['p', new MenuActionViewPerformance(theKarte, false)]
                ])],

                //Export mode
                ['e', new Map([
                    ['a', new MenuActionExportKML(theKarte, true)],
                    ['c', new MenuActionExportKML(theKarte, false)],
                ])],

                //Select active layer
                ['l', new MenuActionLayerSelect(theKarte)],

                //Insert mode
                ['i', new Map([
                    ['l', new MenuActionLayerAdd(theKarte)],
                    ['s', new MenuActionFeatureAdd(theKarte, 'Point')],
                    ['p', new MenuActionFeatureAdd(theKarte, 'Polygon')],
                    ['c', new MenuActionFeatureAdd(theKarte, 'Circle')]
                ])],

                ['m', new MenuActionFeatureModify(theKarte)],

                //Delete mode
                ['d', new Map([
                    ['l', new MenuActionLayerDelete(theKarte)],
                    ['f', new MenuActionFeatureDelete(theKarte)]
                ])],

                //View mode
                ['v', new Map([
                    ['e', new MenuActionViewExtent(theKarte)],
                    ['t', new Map([
                        //Change tile layer
                        ['o', new MenuActionViewTile(theKarte, new ol.source.OSM())],
                        ['a', new MenuActionViewTile(theKarte, new ol.source.XYZ({
                            attributions: 'Tiles Â© <a href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer">ArcGIS</a>',
                            url: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}'
                        }))],
                        ['g', new MenuActionViewTile(theKarte, new ol.source.TileImage({
                            url: 'http://maps.google.com/maps/vt?pb=!1m5!1m4!1i{z}!2i{x}!3i{y}!4i256!2m3!1e0!2sm!3i375060738!3m9!2spl!3sUS!5e18!12m1!1e47!12m3!1e37!2m1!1ssmartmaps!4e0'
                        }))]
                    ])],
                    ['c', new MenuActionViewClusterToggle(theKarte)]
                ])]
            ])
        );

        var theKarteElement = document.createElement("div");
        document.body.append(theKarteElement);
        theKarte.setup(keyboardMenu, theKarteElement, window);

        window.onbeforeunload = function(event) {
            var text = "Do want to reload/close this application? All data will be lost.";
            event.returnValue = text;
            return text;
        };
    }

    </script>

    <body onload="TheKarteLoad()">
    </body>

</html>
